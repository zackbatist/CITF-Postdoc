---
title: "Corpus Analysis Viewer"

format:
  html:
    toc: false
    theme: none
    page-layout: full
    grid: 
      margin-width: 50px
      body-width: 1500px
---


# Corpus Viewer

This document displays the aggregated and coded corpus generated by the pre-render script.

```{=r}
#| label: tbl-corpus-data
# ... (Configuration and filtering steps are already correct) ...

# 4. Generate Tables ONLY for included files
if (length(files_to_process) > 0) {
    
    # Check if the JSON files exist before trying to read them
    # **CRITICAL CHECK:** Ensure the files actually exist (confirming Lua worked)
    files_exist <- all(file.exists(files_to_process))
    
    if (files_exist) {
        # Load all JSON data into a single data frame
        corpus_data_list <- lapply(files_to_process, jsonlite::read_json, simplifyVector = TRUE)
        df_summary <- bind_rows(corpus_data_list)
        
        # ... (knitr::kable code follows) ...
        
    } else {
        # FAIL EXPLICITLY if the JSONs are missing, preventing the unfiltered table.
        warning("JSON files are missing. The Lua aggregation script failed to produce output.")
        # Print a blank table or nothing
        knitr::kable(data.frame(Status = "ERROR: JSON Output Missing"))
    }
    
} else {
    # If there are no files to process after filtering
    cat("\nNo files included in table generation after exclusion.\n")
}

```
### Coded Corpus Content

```{=html}
{{< include _corpus_output/aggregated_corpus.html >}}
```